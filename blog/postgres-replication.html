<!DOCTYPE html><html lang="en"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/7572a3f8628c1f19-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" href="/_next/static/media/a9b61b60c2d733b4-s.p.woff2" as="font" crossorigin="" type="font/woff2"/><link rel="preload" as="image" href="https://avatars.githubusercontent.com/ppvan"/><link rel="stylesheet" href="/_next/static/css/2cee820629769833.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-287e34947b5d6401.js"/><script src="/_next/static/chunks/fd9d1056-1c22282d490653e7.js" async=""></script><script src="/_next/static/chunks/23-f03fca0694745bc2.js" async=""></script><script src="/_next/static/chunks/main-app-e68e20650ad3bba3.js" async=""></script><script src="/_next/static/chunks/231-729c2000e7bf0f03.js" async=""></script><script src="/_next/static/chunks/app/layout-c3ecaed4563f2639.js" async=""></script><script src="/_next/static/chunks/173-8fa9e7bcfdf3a3cf.js" async=""></script><script src="/_next/static/chunks/app/blog/%5Bslug%5D/page-68fa4c94b2d91b55.js" async=""></script><title>ppvan&#x27;s Hub</title><meta name="description" content="My personal space on the internet"/><meta name="author" content="Phạm Văn Phúc"/><link rel="icon" href="/favicon.ico" type="image/x-icon" sizes="128x128"/><meta name="next-size-adjust"/><script src="/_next/static/chunks/polyfills-78c92fac7aa8fdd8.js" noModule=""></script></head><body class="__variable_dbdb1e bg-stone-900 text-violet-50 lg:text-base text-sm font-sans max-w-screen-md lg:p-4 p-1 w-full flex flex-col gap-10 m-auto text-justify"><header class="flex justify-between items-center py-10"><div id="menu" class="flex-grow flex flex-col justify-start"><div id="links" class="flex justify-start lg:gap-4 gap-2"><a class="text-lg text-[#9e98f2] p-2 first:pl-0" href="/">Home</a><a class="text-lg text-[#9e98f2] p-2 first:pl-0" href="/portfolio">Portfolio</a><a class="text-lg text-[#9e98f2] p-2 first:pl-0 font-extrabold underline" href="/blog">Blog</a></div></div><a class="rounded-full w-10 lg:w-12 overflow-hidden" href="https://github.com/ppvan"><img alt="ppvan&#x27;s github avatar" src="https://avatars.githubusercontent.com/ppvan"/></a></header><section><div class="flex justify-between items-center mt-2 mb-8 text-sm max-w-[650px]"><!--$--><p class="text-sm text-neutral-600 dark:text-neutral-400"></p><!--/$--></div><article class="prose prose-quoteless prose-neutral dark:prose-invert"><h1 class="text-slate-200 font-bold font-source text-3xl my-4">Replication guide with postgres and docker compose.</h1>
<blockquote class="bg-transparent opacity-80 border-l-4 border-[#34495e] pl-4 my-4">
<p class="text-slate-400 font-source text-lg">This guide provide some understanding about replication and implemented by <code class="font-source rounded-lg px-2 py-1 highlight"><span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">docker</span><span class="sh__token--sign" style="color: var(--sh-sign)">-</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">compose</span></span></code>.
Realworld replication is strongly tied to deployment.</p>
</blockquote>
<h2 class="text-slate-300 font-semibold font-source text-2xl my-3">Concepts</h2>
<h3 class="text-slate-300 font-source text-xl my-2">Replication</h3>
<p class="text-slate-400 font-source text-lg">Replication is a solution(among many others) to allow a second server to take over quickly if primary server fails(high availibility) or allow serveral server serve same data (load balancer). This document only focus on replication.</p>
<p class="text-slate-400 font-source text-lg">In replication, there are 3 types of server:</p>
<ul class="list-disc pl-8">
<li class="text-slate-400 font-source text-lg">Primary server: read/write queries</li>
<li class="text-slate-400 font-source text-lg">Warn standby server: do nothing until promoted to primary, often use for high availibility</li>
<li class="text-slate-400 font-source text-lg">Hot standby server: read queries, user for load balancing</li>
</ul>
<h3 class="text-slate-300 font-source text-xl my-2">Write ahead logs(WAL)</h3>
<p class="text-slate-400 font-source text-lg">Write ahead logs is a pattern to ensure ACID property of database. Basiclly you write logs before make any changes to database. So you can archive that logs and recorver them on another server.</p>
<p class="text-slate-400 font-source text-lg">Replication can be achieved by continously archive WAL on primary and applying them on replication.</p>
<p class="text-slate-400 font-source text-lg"><a class="text-[#9e98f2] underline" href="https://mermaid.live/edit#pako:eNqNkE1Pg0AQhv_KZk41AQKLfO3BxMRjvdiDieBhClMhBZYsH4qE_-6W2qZGY7qH-dj3mcm7O0EqMwIBu1K-pzmqjq2fkprpU2HbkYpXj0tmGXa4xZZuXo8yqjQvBsriU8FaUgOpb7ktcSAnXm0O-dfwovJ_Vfcv9dIZM022xXTfN-z5fq27u7OnE3i2plFFqdT2xgU8ursG4tdALhhQkaqwyPRXToeRBLqcKkpA6DJDtU8gqWfNYd_JzVinIDrVkwF9ox9IDwW-KaxA7LBs9W2D9YuUP3oQE3yA4IFn8dD3uWNHbuAZMIIwncjSrWfbYahDFPj-bMDnssC2Is_jrst1cOxb7s9fc1ad_A"><img alt="" loading="lazy" decoding="async" data-nimg="1" class="rounded-lg my-4 block m-auto" style="color:transparent" sizes="100vw" srcSet="/_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNqNkE1Pg0AQhv_KZk41AQKLfO3BxMRjvdiDieBhClMhBZYsH4qE_-6W2qZGY7qH-dj3mcm7O0EqMwIBu1K-pzmqjq2fkprpU2HbkYpXj0tmGXa4xZZuXo8yqjQvBsriU8FaUgOpb7ktcSAnXm0O-dfwovJ_Vfcv9dIZM022xXTfN-z5fq27u7OnE3i2plFFqdT2xgU8ursG4tdALhhQkaqwyPRXToeRBLqcKkpA6DJDtU8gqWfNYd_JzVinIDrVkwF9ox9IDwW-KaxA7LBs9W2D9YuUP3oQE3yA4IFn8dD3uWNHbuAZMIIwncjSrWfbYahDFPj-bMDnssC2Is_jrst1cOxb7s9fc1ad_A%3Ftype%3Dpng&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNqNkE1Pg0AQhv_KZk41AQKLfO3BxMRjvdiDieBhClMhBZYsH4qE_-6W2qZGY7qH-dj3mcm7O0EqMwIBu1K-pzmqjq2fkprpU2HbkYpXj0tmGXa4xZZuXo8yqjQvBsriU8FaUgOpb7ktcSAnXm0O-dfwovJ_Vfcv9dIZM022xXTfN-z5fq27u7OnE3i2plFFqdT2xgU8ursG4tdALhhQkaqwyPRXToeRBLqcKkpA6DJDtU8gqWfNYd_JzVinIDrVkwF9ox9IDwW-KaxA7LBs9W2D9YuUP3oQE3yA4IFn8dD3uWNHbuAZMIIwncjSrWfbYahDFPj-bMDnssC2Is_jrst1cOxb7s9fc1ad_A%3Ftype%3Dpng&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNqNkE1Pg0AQhv_KZk41AQKLfO3BxMRjvdiDieBhClMhBZYsH4qE_-6W2qZGY7qH-dj3mcm7O0EqMwIBu1K-pzmqjq2fkprpU2HbkYpXj0tmGXa4xZZuXo8yqjQvBsriU8FaUgOpb7ktcSAnXm0O-dfwovJ_Vfcv9dIZM022xXTfN-z5fq27u7OnE3i2plFFqdT2xgU8ursG4tdALhhQkaqwyPRXToeRBLqcKkpA6DJDtU8gqWfNYd_JzVinIDrVkwF9ox9IDwW-KaxA7LBs9W2D9YuUP3oQE3yA4IFn8dD3uWNHbuAZMIIwncjSrWfbYahDFPj-bMDnssC2Is_jrst1cOxb7s9fc1ad_A%3Ftype%3Dpng&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNqNkE1Pg0AQhv_KZk41AQKLfO3BxMRjvdiDieBhClMhBZYsH4qE_-6W2qZGY7qH-dj3mcm7O0EqMwIBu1K-pzmqjq2fkprpU2HbkYpXj0tmGXa4xZZuXo8yqjQvBsriU8FaUgOpb7ktcSAnXm0O-dfwovJ_Vfcv9dIZM022xXTfN-z5fq27u7OnE3i2plFFqdT2xgU8ursG4tdALhhQkaqwyPRXToeRBLqcKkpA6DJDtU8gqWfNYd_JzVinIDrVkwF9ox9IDwW-KaxA7LBs9W2D9YuUP3oQE3yA4IFn8dD3uWNHbuAZMIIwncjSrWfbYahDFPj-bMDnssC2Is_jrst1cOxb7s9fc1ad_A%3Ftype%3Dpng&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNqNkE1Pg0AQhv_KZk41AQKLfO3BxMRjvdiDieBhClMhBZYsH4qE_-6W2qZGY7qH-dj3mcm7O0EqMwIBu1K-pzmqjq2fkprpU2HbkYpXj0tmGXa4xZZuXo8yqjQvBsriU8FaUgOpb7ktcSAnXm0O-dfwovJ_Vfcv9dIZM022xXTfN-z5fq27u7OnE3i2plFFqdT2xgU8ursG4tdALhhQkaqwyPRXToeRBLqcKkpA6DJDtU8gqWfNYd_JzVinIDrVkwF9ox9IDwW-KaxA7LBs9W2D9YuUP3oQE3yA4IFn8dD3uWNHbuAZMIIwncjSrWfbYahDFPj-bMDnssC2Is_jrst1cOxb7s9fc1ad_A%3Ftype%3Dpng&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNqNkE1Pg0AQhv_KZk41AQKLfO3BxMRjvdiDieBhClMhBZYsH4qE_-6W2qZGY7qH-dj3mcm7O0EqMwIBu1K-pzmqjq2fkprpU2HbkYpXj0tmGXa4xZZuXo8yqjQvBsriU8FaUgOpb7ktcSAnXm0O-dfwovJ_Vfcv9dIZM022xXTfN-z5fq27u7OnE3i2plFFqdT2xgU8ursG4tdALhhQkaqwyPRXToeRBLqcKkpA6DJDtU8gqWfNYd_JzVinIDrVkwF9ox9IDwW-KaxA7LBs9W2D9YuUP3oQE3yA4IFn8dD3uWNHbuAZMIIwncjSrWfbYahDFPj-bMDnssC2Is_jrst1cOxb7s9fc1ad_A%3Ftype%3Dpng&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNqNkE1Pg0AQhv_KZk41AQKLfO3BxMRjvdiDieBhClMhBZYsH4qE_-6W2qZGY7qH-dj3mcm7O0EqMwIBu1K-pzmqjq2fkprpU2HbkYpXj0tmGXa4xZZuXo8yqjQvBsriU8FaUgOpb7ktcSAnXm0O-dfwovJ_Vfcv9dIZM022xXTfN-z5fq27u7OnE3i2plFFqdT2xgU8ursG4tdALhhQkaqwyPRXToeRBLqcKkpA6DJDtU8gqWfNYd_JzVinIDrVkwF9ox9IDwW-KaxA7LBs9W2D9YuUP3oQE3yA4IFn8dD3uWNHbuAZMIIwncjSrWfbYahDFPj-bMDnssC2Is_jrst1cOxb7s9fc1ad_A%3Ftype%3Dpng&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNqNkE1Pg0AQhv_KZk41AQKLfO3BxMRjvdiDieBhClMhBZYsH4qE_-6W2qZGY7qH-dj3mcm7O0EqMwIBu1K-pzmqjq2fkprpU2HbkYpXj0tmGXa4xZZuXo8yqjQvBsriU8FaUgOpb7ktcSAnXm0O-dfwovJ_Vfcv9dIZM022xXTfN-z5fq27u7OnE3i2plFFqdT2xgU8ursG4tdALhhQkaqwyPRXToeRBLqcKkpA6DJDtU8gqWfNYd_JzVinIDrVkwF9ox9IDwW-KaxA7LBs9W2D9YuUP3oQE3yA4IFn8dD3uWNHbuAZMIIwncjSrWfbYahDFPj-bMDnssC2Is_jrst1cOxb7s9fc1ad_A%3Ftype%3Dpng&amp;w=3840&amp;q=75 3840w" src="/_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNqNkE1Pg0AQhv_KZk41AQKLfO3BxMRjvdiDieBhClMhBZYsH4qE_-6W2qZGY7qH-dj3mcm7O0EqMwIBu1K-pzmqjq2fkprpU2HbkYpXj0tmGXa4xZZuXo8yqjQvBsriU8FaUgOpb7ktcSAnXm0O-dfwovJ_Vfcv9dIZM022xXTfN-z5fq27u7OnE3i2plFFqdT2xgU8ursG4tdALhhQkaqwyPRXToeRBLqcKkpA6DJDtU8gqWfNYd_JzVinIDrVkwF9ox9IDwW-KaxA7LBs9W2D9YuUP3oQE3yA4IFn8dD3uWNHbuAZMIIwncjSrWfbYahDFPj-bMDnssC2Is_jrst1cOxb7s9fc1ad_A%3Ftype%3Dpng&amp;w=3840&amp;q=75"/></a></p>
<p class="text-slate-400 font-source text-lg">Note that the process is async by default, so slaves may not be up-to-date with master. This can be solved by streaming WAL over TCP and setup a synchronous slave. Even so, there is a window for data loss should the primary server suffer a catastrophic failure; transactions not yet shipped will be lost</p>
<p class="text-slate-400 font-source text-lg"><a class="text-[#9e98f2] underline" href="https://mermaid.live/edit#pako:eNp9kE1LxDAQhv9KGFhYoS1tar9yEASP68U9CLYexnbWFvuxJGl1Lf3vpnVlEaUJzDuT551kyAh5VxAIONTde16i1Gz3kLXMrAaVJplu7xdlBWp8QUVXz994s2Eo87IaqEh_EqZIDiTPDlXjQF663c_6p3-hfJX6_9F5X8Zjts0eb3fK6M35wXXM17EPFjQkG6wK8ynjbM5Al9RQBsKkBcq3DLJ2Mj7sdbc_tTkILXuyoD-aOemuwleJDYgD1sqcHrF96rpfNYgRPkDwKHB4HIbccxM_Ciw4gbC9xDFl4LpxbEISheFkwedygeskQcB9n5vgudc8nL4AHKiJ6A"><img alt="" loading="lazy" decoding="async" data-nimg="1" class="rounded-lg my-4 block m-auto" style="color:transparent" sizes="100vw" srcSet="/_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNp9kE1LxDAQhv9KGFhYoS1tar9yEASP68U9CLYexnbWFvuxJGl1Lf3vpnVlEaUJzDuT551kyAh5VxAIONTde16i1Gz3kLXMrAaVJplu7xdlBWp8QUVXz994s2Eo87IaqEh_EqZIDiTPDlXjQF663c_6p3-hfJX6_9F5X8Zjts0eb3fK6M35wXXM17EPFjQkG6wK8ynjbM5Al9RQBsKkBcq3DLJ2Mj7sdbc_tTkILXuyoD-aOemuwleJDYgD1sqcHrF96rpfNYgRPkDwKHB4HIbccxM_Ciw4gbC9xDFl4LpxbEISheFkwedygeskQcB9n5vgudc8nL4AHKiJ6A%3Ftype%3Dpng&amp;w=640&amp;q=75 640w, /_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNp9kE1LxDAQhv9KGFhYoS1tar9yEASP68U9CLYexnbWFvuxJGl1Lf3vpnVlEaUJzDuT551kyAh5VxAIONTde16i1Gz3kLXMrAaVJplu7xdlBWp8QUVXz994s2Eo87IaqEh_EqZIDiTPDlXjQF663c_6p3-hfJX6_9F5X8Zjts0eb3fK6M35wXXM17EPFjQkG6wK8ynjbM5Al9RQBsKkBcq3DLJ2Mj7sdbc_tTkILXuyoD-aOemuwleJDYgD1sqcHrF96rpfNYgRPkDwKHB4HIbccxM_Ciw4gbC9xDFl4LpxbEISheFkwedygeskQcB9n5vgudc8nL4AHKiJ6A%3Ftype%3Dpng&amp;w=750&amp;q=75 750w, /_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNp9kE1LxDAQhv9KGFhYoS1tar9yEASP68U9CLYexnbWFvuxJGl1Lf3vpnVlEaUJzDuT551kyAh5VxAIONTde16i1Gz3kLXMrAaVJplu7xdlBWp8QUVXz994s2Eo87IaqEh_EqZIDiTPDlXjQF663c_6p3-hfJX6_9F5X8Zjts0eb3fK6M35wXXM17EPFjQkG6wK8ynjbM5Al9RQBsKkBcq3DLJ2Mj7sdbc_tTkILXuyoD-aOemuwleJDYgD1sqcHrF96rpfNYgRPkDwKHB4HIbccxM_Ciw4gbC9xDFl4LpxbEISheFkwedygeskQcB9n5vgudc8nL4AHKiJ6A%3Ftype%3Dpng&amp;w=828&amp;q=75 828w, /_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNp9kE1LxDAQhv9KGFhYoS1tar9yEASP68U9CLYexnbWFvuxJGl1Lf3vpnVlEaUJzDuT551kyAh5VxAIONTde16i1Gz3kLXMrAaVJplu7xdlBWp8QUVXz994s2Eo87IaqEh_EqZIDiTPDlXjQF663c_6p3-hfJX6_9F5X8Zjts0eb3fK6M35wXXM17EPFjQkG6wK8ynjbM5Al9RQBsKkBcq3DLJ2Mj7sdbc_tTkILXuyoD-aOemuwleJDYgD1sqcHrF96rpfNYgRPkDwKHB4HIbccxM_Ciw4gbC9xDFl4LpxbEISheFkwedygeskQcB9n5vgudc8nL4AHKiJ6A%3Ftype%3Dpng&amp;w=1080&amp;q=75 1080w, /_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNp9kE1LxDAQhv9KGFhYoS1tar9yEASP68U9CLYexnbWFvuxJGl1Lf3vpnVlEaUJzDuT551kyAh5VxAIONTde16i1Gz3kLXMrAaVJplu7xdlBWp8QUVXz994s2Eo87IaqEh_EqZIDiTPDlXjQF663c_6p3-hfJX6_9F5X8Zjts0eb3fK6M35wXXM17EPFjQkG6wK8ynjbM5Al9RQBsKkBcq3DLJ2Mj7sdbc_tTkILXuyoD-aOemuwleJDYgD1sqcHrF96rpfNYgRPkDwKHB4HIbccxM_Ciw4gbC9xDFl4LpxbEISheFkwedygeskQcB9n5vgudc8nL4AHKiJ6A%3Ftype%3Dpng&amp;w=1200&amp;q=75 1200w, /_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNp9kE1LxDAQhv9KGFhYoS1tar9yEASP68U9CLYexnbWFvuxJGl1Lf3vpnVlEaUJzDuT551kyAh5VxAIONTde16i1Gz3kLXMrAaVJplu7xdlBWp8QUVXz994s2Eo87IaqEh_EqZIDiTPDlXjQF663c_6p3-hfJX6_9F5X8Zjts0eb3fK6M35wXXM17EPFjQkG6wK8ynjbM5Al9RQBsKkBcq3DLJ2Mj7sdbc_tTkILXuyoD-aOemuwleJDYgD1sqcHrF96rpfNYgRPkDwKHB4HIbccxM_Ciw4gbC9xDFl4LpxbEISheFkwedygeskQcB9n5vgudc8nL4AHKiJ6A%3Ftype%3Dpng&amp;w=1920&amp;q=75 1920w, /_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNp9kE1LxDAQhv9KGFhYoS1tar9yEASP68U9CLYexnbWFvuxJGl1Lf3vpnVlEaUJzDuT551kyAh5VxAIONTde16i1Gz3kLXMrAaVJplu7xdlBWp8QUVXz994s2Eo87IaqEh_EqZIDiTPDlXjQF663c_6p3-hfJX6_9F5X8Zjts0eb3fK6M35wXXM17EPFjQkG6wK8ynjbM5Al9RQBsKkBcq3DLJ2Mj7sdbc_tTkILXuyoD-aOemuwleJDYgD1sqcHrF96rpfNYgRPkDwKHB4HIbccxM_Ciw4gbC9xDFl4LpxbEISheFkwedygeskQcB9n5vgudc8nL4AHKiJ6A%3Ftype%3Dpng&amp;w=2048&amp;q=75 2048w, /_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNp9kE1LxDAQhv9KGFhYoS1tar9yEASP68U9CLYexnbWFvuxJGl1Lf3vpnVlEaUJzDuT551kyAh5VxAIONTde16i1Gz3kLXMrAaVJplu7xdlBWp8QUVXz994s2Eo87IaqEh_EqZIDiTPDlXjQF663c_6p3-hfJX6_9F5X8Zjts0eb3fK6M35wXXM17EPFjQkG6wK8ynjbM5Al9RQBsKkBcq3DLJ2Mj7sdbc_tTkILXuyoD-aOemuwleJDYgD1sqcHrF96rpfNYgRPkDwKHB4HIbccxM_Ciw4gbC9xDFl4LpxbEISheFkwedygeskQcB9n5vgudc8nL4AHKiJ6A%3Ftype%3Dpng&amp;w=3840&amp;q=75 3840w" src="/_next/image?url=https%3A%2F%2Fmermaid.ink%2Fimg%2Fpako%3AeNp9kE1LxDAQhv9KGFhYoS1tar9yEASP68U9CLYexnbWFvuxJGl1Lf3vpnVlEaUJzDuT551kyAh5VxAIONTde16i1Gz3kLXMrAaVJplu7xdlBWp8QUVXz994s2Eo87IaqEh_EqZIDiTPDlXjQF663c_6p3-hfJX6_9F5X8Zjts0eb3fK6M35wXXM17EPFjQkG6wK8ynjbM5Al9RQBsKkBcq3DLJ2Mj7sdbc_tTkILXuyoD-aOemuwleJDYgD1sqcHrF96rpfNYgRPkDwKHB4HIbccxM_Ciw4gbC9xDFl4LpxbEISheFkwedygeskQcB9n5vgudc8nL4AHKiJ6A%3Ftype%3Dpng&amp;w=3840&amp;q=75"/></a></p>
<h3 class="text-slate-300 font-source text-xl my-2">Slave life-cycle</h3>
<h3 class="text-slate-300 font-source text-xl my-2">Failover problems</h3>
<h2 class="text-slate-300 font-semibold font-source text-2xl my-3">Setup and config</h2>
<blockquote class="bg-transparent opacity-80 border-l-4 border-[#34495e] pl-4 my-4">
<p class="text-slate-400 font-source text-lg">Heavily specialize in docker evironment. You can get full setup using docker compose <a class="text-[#9e98f2] underline" href="https://github.com/ppvan/master-slave-todos">here</a></p>
</blockquote>
<h3 class="text-slate-300 font-source text-xl my-2">Config master node</h3>
<h4 class="text-slate-300 font-source text-lg my-1">Create archive directory</h4>
<pre class="bg-[#21262d] rounded p-1 overflow-x-auto"><code class="language-sh"><span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">sudo</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">mkdir</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">-</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">p</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--keyword" style="color: var(--sh-keyword)">var</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">lib</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">postgresql</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">archive</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">sudo</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">chmod</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--class" style="color: var(--sh-class)">700</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--keyword" style="color: var(--sh-keyword)">var</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">lib</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">postgresql</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">archive</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">sudo</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">chown</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">postgres</span><span class="sh__token--sign" style="color: var(--sh-sign)">:</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">postgres</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--keyword" style="color: var(--sh-keyword)">var</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">lib</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">postgresql</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">archive</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span></code></pre>
<h4 class="text-slate-300 font-source text-lg my-1">Config postgres.conf</h4>
<pre class="bg-[#21262d] rounded p-1 overflow-x-auto"><code class="language-conf"><span class="sh__line"><span class="sh__token--sign" style="color: var(--sh-sign)">#</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--keyword" style="color: var(--sh-keyword)">var</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">lib</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">postgresql</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">data</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">postgresql</span><span class="sh__token--sign" style="color: var(--sh-sign)">.</span><span class="sh__token--property" style="color: var(--sh-property)">conf</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">listen_addresses</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">=</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--string" style="color: var(--sh-string)">&#039;</span><span class="sh__token--string" style="color: var(--sh-string)">*</span><span class="sh__token--string" style="color: var(--sh-string)">&#039;</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">#</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">need</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--keyword" style="color: var(--sh-keyword)">in</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">docker</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">container</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">wal_level</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">=</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">hot_standby</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">synchronous_commit</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">=</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">on</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">#</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">syncchoronous</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">standby</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">archive_mode</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">=</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">on</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">#</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">also</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">archive</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--class" style="color: var(--sh-class)">WALs</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">archive_command</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">=</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--string" style="color: var(--sh-string)">&#039;</span><span class="sh__token--string" style="color: var(--sh-string)">cp %p /var/lib/postgresql/archive/%f</span><span class="sh__token--string" style="color: var(--sh-string)">&#039;</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">max_wal_senders</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">=</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--class" style="color: var(--sh-class)">2</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">wal_keep_segments</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">=</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--class" style="color: var(--sh-class)">10</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">synchronous_standby_names</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">=</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--string" style="color: var(--sh-string)">&#039;</span><span class="sh__token--string" style="color: var(--sh-string)">slave_db</span><span class="sh__token--string" style="color: var(--sh-string)">&#039;</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">#</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">slave</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">name</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span></code></pre>
<h4 class="text-slate-300 font-source text-lg my-1">Create replication user with replication priviledge</h4>
<pre class="bg-[#21262d] rounded p-1 overflow-x-auto"><code class="language-sql"><span class="sh__line"><span class="sh__token--class" style="color: var(--sh-class)">CREATE</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--class" style="color: var(--sh-class)">ROLE</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">replica</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--class" style="color: var(--sh-class)">LOGIN</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--class" style="color: var(--sh-class)">REPLICATION</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--class" style="color: var(--sh-class)">PASSWORD</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--string" style="color: var(--sh-string)">&#039;</span><span class="sh__token--string" style="color: var(--sh-string)">replica</span><span class="sh__token--string" style="color: var(--sh-string)">&#039;</span><span class="sh__token--sign" style="color: var(--sh-sign)">;</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--class" style="color: var(--sh-class)">ALTER</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--class" style="color: var(--sh-class)">ROLE</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">replica</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--class" style="color: var(--sh-class)">WITH</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--class" style="color: var(--sh-class)">CONNECTION</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--class" style="color: var(--sh-class)">LIMIT</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--class" style="color: var(--sh-class)">8</span><span class="sh__token--sign" style="color: var(--sh-sign)">;</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span></code></pre>
<h3 class="text-slate-300 font-source text-xl my-2">Allow remote replica connect</h3>
<blockquote class="bg-transparent opacity-80 border-l-4 border-[#34495e] pl-4 my-4">
<p class="text-slate-400 font-source text-lg">Add following to the end of pg_hba.conf</p>
</blockquote>
<pre class="bg-[#21262d] rounded p-1 overflow-x-auto"><code class="language-conf"><span class="sh__line"><span class="sh__token--sign" style="color: var(--sh-sign)">#</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--string" style="color: var(--sh-string)">/var/lib</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">postgresql</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">data</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">pg_hba</span><span class="sh__token--sign" style="color: var(--sh-sign)">.</span><span class="sh__token--property" style="color: var(--sh-property)">conf</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">host</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--space" style="color: var(--sh-space)">   </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">replication</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--space" style="color: var(--sh-space)">    </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">replica</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--space" style="color: var(--sh-space)">        </span><span class="sh__token--class" style="color: var(--sh-class)">0</span><span class="sh__token--sign" style="color: var(--sh-sign)">.</span><span class="sh__token--class" style="color: var(--sh-class)">0</span><span class="sh__token--sign" style="color: var(--sh-sign)">.</span><span class="sh__token--class" style="color: var(--sh-class)">0</span><span class="sh__token--sign" style="color: var(--sh-sign)">.</span><span class="sh__token--class" style="color: var(--sh-class)">0</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--class" style="color: var(--sh-class)">0</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--space" style="color: var(--sh-space)">        </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">md5</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span></code></pre>
<h3 class="text-slate-300 font-source text-xl my-2">Config slave node</h3>
<h4 class="text-slate-300 font-source text-lg my-1">Replication master data</h4>
<pre class="bg-[#21262d] rounded p-1 overflow-x-auto"><code class="language-sh"><span class="sh__line"><span class="sh__token--sign" style="color: var(--sh-sign)">#</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--keyword" style="color: var(--sh-keyword)">export</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--class" style="color: var(--sh-class)">PGDATA</span><span class="sh__token--sign" style="color: var(--sh-sign)">=</span><span class="sh__token--string" style="color: var(--sh-string)">/var/lib</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">postgresql</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">data</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">rm</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">-</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">rf</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--string" style="color: var(--sh-string)">&quot;</span><span class="sh__token--string" style="color: var(--sh-string)">${PGDATA}</span><span class="sh__token--string" style="color: var(--sh-string)">&quot;</span><span class="sh__token--comment" style="color: var(--sh-comment)">/*</span></span>
<span class="sh__line"><span class="sh__token--comment" style="color: var(--sh-comment)"></span></span>
<span class="sh__line"><span class="sh__token--comment" style="color: var(--sh-comment)">pg_basebackup -d &quot;user=replica password=replica host=db&quot; -D &quot;${PGDATA}&quot; -Fp -Xs -P -R</span></span>
<span class="sh__line"><span class="sh__token--comment" style="color: var(--sh-comment)"></span></span></code></pre>
<h4 class="text-slate-300 font-source text-lg my-1">Create config and standby.signal</h4>
<blockquote class="bg-transparent opacity-80 border-l-4 border-[#34495e] pl-4 my-4">
<p class="text-slate-400 font-source text-lg">standby.signal is needed so postgres change to standby mode (slave mode)</p>
</blockquote>
<pre class="bg-[#21262d] rounded p-1 overflow-x-auto"><code class="language-conf"><span class="sh__line"><span class="sh__token--sign" style="color: var(--sh-sign)">#</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--keyword" style="color: var(--sh-keyword)">var</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">lib</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">postgresql</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">data</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">postgresql</span><span class="sh__token--sign" style="color: var(--sh-sign)">.</span><span class="sh__token--property" style="color: var(--sh-property)">conf</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">listen_addresses</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">=</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--string" style="color: var(--sh-string)">&#039;</span><span class="sh__token--string" style="color: var(--sh-string)">*</span><span class="sh__token--string" style="color: var(--sh-string)">&#039;</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">#</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">need</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--keyword" style="color: var(--sh-keyword)">in</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">docker</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">container</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">wal_level</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">=</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--identifier" style="color: var(--sh-identifier)">hot_standby</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span></code></pre>
<pre class="bg-[#21262d] rounded p-1 overflow-x-auto"><code class="language-conf"><span class="sh__line"><span class="sh__token--sign" style="color: var(--sh-sign)">#</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--keyword" style="color: var(--sh-keyword)">var</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">lib</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">postgresql</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">data</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">postgresql</span><span class="sh__token--sign" style="color: var(--sh-sign)">.</span><span class="sh__token--property" style="color: var(--sh-property)">auto</span><span class="sh__token--sign" style="color: var(--sh-sign)">.</span><span class="sh__token--property" style="color: var(--sh-property)">conf</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span>
<span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">primary_conninfo</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--sign" style="color: var(--sh-sign)">=</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--string" style="color: var(--sh-string)">&#039;</span><span class="sh__token--string" style="color: var(--sh-string)">user=replica password=replica host=db port=5432 sslmode=prefer sslcompression=0 gssencmode=disable target_session_attrs=any application_name=slave_db</span><span class="sh__token--string" style="color: var(--sh-string)">&#039;</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span></code></pre>
<pre class="bg-[#21262d] rounded p-1 overflow-x-auto"><code class="language-sh"><span class="sh__line"><span class="sh__token--identifier" style="color: var(--sh-identifier)">touch</span><span class="sh__token--space" style="color: var(--sh-space)"> </span><span class="sh__token--keyword" style="color: var(--sh-keyword)">var</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">lib</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">postgresql</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">data</span><span class="sh__token--sign" style="color: var(--sh-sign)">/</span><span class="sh__token--identifier" style="color: var(--sh-identifier)">standby</span><span class="sh__token--sign" style="color: var(--sh-sign)">.</span><span class="sh__token--property" style="color: var(--sh-property)">signal</span><span class="sh__token--break" style="color: var(--sh-break)"></span></span></code></pre>
<h2 class="text-slate-300 font-semibold font-source text-2xl my-3">Reference</h2>
<p class="text-slate-400 font-source text-lg"><a class="text-[#9e98f2] underline" href="https://www.postgresql.org/docs/current/high-availability.html">Postgresql documentation, chapter 27</a></p>
<p class="text-slate-400 font-source text-lg"><a class="text-[#9e98f2] underline" href="https://www.postgresql.vn/blog/setup_master_slave_for_postgres12">Postgres VN, setup master slave</a></p></article></section><footer class="h-20"></footer><script src="/_next/static/chunks/webpack-287e34947b5d6401.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0]);self.__next_f.push([2,null])</script><script>self.__next_f.push([1,"1:HL[\"/_next/static/media/7572a3f8628c1f19-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n2:HL[\"/_next/static/media/a9b61b60c2d733b4-s.p.woff2\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/woff2\"}]\n3:HL[\"/_next/static/css/2cee820629769833.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"4:I[5751,[],\"\"]\n6:\"$Sreact.suspense\"\n8:I[9275,[],\"\"]\na:I[1343,[],\"\"]\nb:I[7929,[\"231\",\"static/chunks/231-729c2000e7bf0f03.js\",\"185\",\"static/chunks/app/layout-c3ecaed4563f2639.js\"],\"default\"]\nc:I[231,[\"231\",\"static/chunks/231-729c2000e7bf0f03.js\",\"173\",\"static/chunks/173-8fa9e7bcfdf3a3cf.js\",\"308\",\"static/chunks/app/blog/%5Bslug%5D/page-68fa4c94b2d91b55.js\"],\"\"]\ne:I[6130,[],\"\"]\n9:[\"slug\",\"postgres-replication\",\"d\"]\nf:[]\n"])</script><script>self.__next_f.push([1,"0:[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/2cee820629769833.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\"}]],[\"$\",\"$L4\",null,{\"buildId\":\"YFgTie-JpjAiTSvVqKkYC\",\"assetPrefix\":\"\",\"initialCanonicalUrl\":\"/blog/postgres-replication\",\"initialTree\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"postgres-replication\",\"d\"],{\"children\":[\"__PAGE__?{\\\"slug\\\":\\\"postgres-replication\\\"}\",{}]}]}]},\"$undefined\",\"$undefined\",true],\"initialSeedData\":[\"\",{\"children\":[\"blog\",{\"children\":[[\"slug\",\"postgres-replication\",\"d\"],{\"children\":[\"__PAGE__\",{},[[\"$L5\",[\"$\",\"section\",null,{\"children\":[[\"$\",\"div\",null,{\"className\":\"flex justify-between items-center mt-2 mb-8 text-sm max-w-[650px]\",\"children\":[\"$\",\"$6\",null,{\"fallback\":[\"$\",\"p\",null,{\"className\":\"h-5\"}],\"children\":[\"$\",\"p\",null,{\"className\":\"text-sm text-neutral-600 dark:text-neutral-400\"}]}]}],[\"$\",\"article\",null,{\"className\":\"prose prose-quoteless prose-neutral dark:prose-invert\",\"children\":\"$L7\"}]]}]],null],null]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\",\"$9\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"blog\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"notFoundStyles\":\"$undefined\",\"styles\":null}],null]},[[\"$\",\"html\",null,{\"lang\":\"en\",\"children\":[\"$\",\"body\",null,{\"className\":\"__variable_dbdb1e bg-stone-900 text-violet-50 lg:text-base text-sm font-sans max-w-screen-md lg:p-4 p-1 w-full flex flex-col gap-10 m-auto text-justify\",\"children\":[[\"$\",\"header\",null,{\"className\":\"flex justify-between items-center py-10\",\"children\":[[\"$\",\"div\",null,{\"id\":\"menu\",\"className\":\"flex-grow flex flex-col justify-start\",\"children\":[\"$\",\"$Lb\",null,{}]}],[\"$\",\"$Lc\",null,{\"href\":\"https://github.com/ppvan\",\"className\":\"rounded-full w-10 lg:w-12 overflow-hidden\",\"children\":[\"$\",\"img\",null,{\"alt\":\"ppvan's github avatar\",\"src\":\"https://avatars.githubusercontent.com/ppvan\"}]}]]}],[\"$\",\"$L8\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$La\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":\"404\"}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]],\"notFoundStyles\":[],\"styles\":null}],[\"$\",\"footer\",null,{\"className\":\"h-20\"}]]}]}],null],null],\"couldBeIntercepted\":false,\"initialHead\":[false,\"$Ld\"],\"globalErrorComponent\":\"$e\",\"missingSlots\":\"$Wf\"}]]\n"])</script><script>self.__next_f.push([1,"10:I[8173,[\"231\",\"static/chunks/231-729c2000e7bf0f03.js\",\"173\",\"static/chunks/173-8fa9e7bcfdf3a3cf.js\",\"308\",\"static/chunks/app/blog/%5Bslug%5D/page-68fa4c94b2d91b55.js\"],\"Image\"]\n11:Te7b,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003esudo\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003emkdir\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e-\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003ep\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--keyword\" style=\"color: var(--sh-keyword)\"\u003evar\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003elib\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003epostgresql\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003earchive\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003esudo\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003echmod\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003e700\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--keyword\" style=\"color: var(--sh-keyword)\"\u003evar\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003elib\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003epostgresql\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003earchive\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003esudo\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003echown\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003epostgres\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e:\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003epostgres\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--keyword\" style=\"color: var(--sh-keyword)\"\u003evar\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003elib\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003epostgresql\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003earchive\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e"])</script><script>self.__next_f.push([1,"12:T1e47,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e#\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--keyword\" style=\"color: var(--sh-keyword)\"\u003evar\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003elib\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003epostgresql\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003edata\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003epostgresql\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e.\u003c/span\u003e\u003cspan class=\"sh__token--property\" style=\"color: var(--sh-property)\"\u003econf\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003elisten_addresses\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e=\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e\u0026#039;\u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e*\u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e\u0026#039;\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e#\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003eneed\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--keyword\" style=\"color: var(--sh-keyword)\"\u003ein\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003edocker\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003econtainer\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003ewal_level\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e=\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003ehot_standby\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003esynchronous_commit\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e=\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003eon\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e#\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003esyncchoronous\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003estandby\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003earchive_mode\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e=\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003eon\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e#\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003ealso\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003earchive\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003eWALs\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003earchive_command\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e=\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e\u0026#039;\u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003ecp %p /var/lib/postgresql/archive/%f\u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e\u0026#039;\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003emax_wal_senders\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e=\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003e2\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003ewal_keep_segments\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e=\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003e10\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003esynchronous_standby_names\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e=\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e\u0026#039;\u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003eslave_db\u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e\u0026#039;\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e#\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003eslave\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003ename\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e"])</script><script>self.__next_f.push([1,"13:T961,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003eCREATE\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003eROLE\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003ereplica\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003eLOGIN\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003eREPLICATION\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003ePASSWORD\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e\u0026#039;\u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003ereplica\u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e\u0026#039;\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e;\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003eALTER\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003eROLE\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003ereplica\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003eWITH\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003eCONNECTION\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003eLIMIT\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003e8\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e;\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e"])</script><script>self.__next_f.push([1,"14:Ta6a,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e#\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e/var/lib\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003epostgresql\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003edata\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003epg_hba\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e.\u003c/span\u003e\u003cspan class=\"sh__token--property\" style=\"color: var(--sh-property)\"\u003econf\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003ehost\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e   \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003ereplication\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e    \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003ereplica\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e        \u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003e0\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e.\u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003e0\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e.\u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003e0\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e.\u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003e0\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003e0\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e        \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003emd5\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e"])</script><script>self.__next_f.push([1,"15:T85f,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e#\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--keyword\" style=\"color: var(--sh-keyword)\"\u003eexport\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--class\" style=\"color: var(--sh-class)\"\u003ePGDATA\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e=\u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e/var/lib\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003epostgresql\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003edata\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003erm\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e-\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003erf\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e${PGDATA}\u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e\u0026quot;\u003c/span\u003e\u003cspan class=\"sh__token--comment\" style=\"color: var(--sh-comment)\"\u003e/*\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--comment\" style=\"color: var(--sh-comment)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--comment\" style=\"color: var(--sh-comment)\"\u003epg_basebackup -d \u0026quot;user=replica password=replica host=db\u0026quot; -D \u0026quot;${PGDATA}\u0026quot; -Fp -Xs -P -R\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--comment\" style=\"color: var(--sh-comment)\"\u003e\u003c/span\u003e\u003c/span\u003e"])</script><script>self.__next_f.push([1,"16:Tbdf,"])</script><script>self.__next_f.push([1,"\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e#\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--keyword\" style=\"color: var(--sh-keyword)\"\u003evar\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003elib\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003epostgresql\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003edata\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003epostgresql\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e.\u003c/span\u003e\u003cspan class=\"sh__token--property\" style=\"color: var(--sh-property)\"\u003econf\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003elisten_addresses\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e=\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e\u0026#039;\u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e*\u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e\u0026#039;\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e#\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003eneed\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--keyword\" style=\"color: var(--sh-keyword)\"\u003ein\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003edocker\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003econtainer\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003ewal_level\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e=\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003ehot_standby\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e"])</script><script>self.__next_f.push([1,"17:T7cf,\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e#\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--keyword\" style=\"color: var(--sh-keyword)\"\u003evar\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003elib\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003epostgresql\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003edata\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003epostgresql\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e.\u003c/span\u003e\u003cspan class=\"sh__token--property\" style=\"color: var(--sh-property)\"\u003eauto\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e.\u003c/span\u003e\u003cspan class=\"sh__token--property\" style=\"color: var(--sh-property)\"\u003econf\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"sh__line\"\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003eprimary_conninfo\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e=\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e\u0026#039;\u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003euser=replica password=replica host=db port=5432 sslmode=prefer sslcompression=0 gssencmode=disable target_session_attrs=any application_name=slave_db\u003c/span\u003e\u003cspan class=\"sh__token--string\" style=\"color: var(--sh-string)\"\u003e\u0026#039;\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e18:T442,\u003cspan class=\"sh__line\"\u003e\u003cspan clas"])</script><script>self.__next_f.push([1,"s=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003etouch\u003c/span\u003e\u003cspan class=\"sh__token--space\" style=\"color: var(--sh-space)\"\u003e \u003c/span\u003e\u003cspan class=\"sh__token--keyword\" style=\"color: var(--sh-keyword)\"\u003evar\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003elib\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003epostgresql\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003edata\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e/\u003c/span\u003e\u003cspan class=\"sh__token--identifier\" style=\"color: var(--sh-identifier)\"\u003estandby\u003c/span\u003e\u003cspan class=\"sh__token--sign\" style=\"color: var(--sh-sign)\"\u003e.\u003c/span\u003e\u003cspan class=\"sh__token--property\" style=\"color: var(--sh-property)\"\u003esignal\u003c/span\u003e\u003cspan class=\"sh__token--break\" style=\"color: var(--sh-break)\"\u003e\u003c/span\u003e\u003c/span\u003e"])</script><script>self.__next_f.push([1,"7:[[\"$\",\"h1\",null,{\"className\":\"text-slate-200 font-bold font-source text-3xl my-4\",\"children\":\"Replication guide with postgres and docker compose.\"}],\"\\n\",[\"$\",\"blockquote\",null,{\"className\":\"bg-transparent opacity-80 border-l-4 border-[#34495e] pl-4 my-4\",\"children\":[\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-slate-400 font-source text-lg\",\"children\":[\"This guide provide some understanding about replication and implemented by \",[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"\u003cspan class=\\\"sh__line\\\"\u003e\u003cspan class=\\\"sh__token--identifier\\\" style=\\\"color: var(--sh-identifier)\\\"\u003edocker\u003c/span\u003e\u003cspan class=\\\"sh__token--sign\\\" style=\\\"color: var(--sh-sign)\\\"\u003e-\u003c/span\u003e\u003cspan class=\\\"sh__token--identifier\\\" style=\\\"color: var(--sh-identifier)\\\"\u003ecompose\u003c/span\u003e\u003c/span\u003e\"},\"className\":\"font-source rounded-lg px-2 py-1 highlight\"}],\".\\nRealworld replication is strongly tied to deployment.\"]}],\"\\n\"]}],\"\\n\",[\"$\",\"h2\",null,{\"className\":\"text-slate-300 font-semibold font-source text-2xl my-3\",\"children\":\"Concepts\"}],\"\\n\",[\"$\",\"h3\",null,{\"className\":\"text-slate-300 font-source text-xl my-2\",\"children\":\"Replication\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-slate-400 font-source text-lg\",\"children\":\"Replication is a solution(among many others) to allow a second server to take over quickly if primary server fails(high availibility) or allow serveral server serve same data (load balancer). This document only focus on replication.\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-slate-400 font-source text-lg\",\"children\":\"In replication, there are 3 types of server:\"}],\"\\n\",[\"$\",\"ul\",null,{\"className\":\"list-disc pl-8\",\"children\":[\"\\n\",[\"$\",\"li\",null,{\"className\":\"text-slate-400 font-source text-lg\",\"children\":\"Primary server: read/write queries\"}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"text-slate-400 font-source text-lg\",\"children\":\"Warn standby server: do nothing until promoted to primary, often use for high availibility\"}],\"\\n\",[\"$\",\"li\",null,{\"className\":\"text-slate-400 font-source text-lg\",\"children\":\"Hot standby server: read queries, user for load balancing\"}],\"\\n\"]}],\"\\n\",[\"$\",\"h3\",null,{\"className\":\"text-slate-300 font-source text-xl my-2\",\"children\":\"Write ahead logs(WAL)\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-slate-400 font-source text-lg\",\"children\":\"Write ahead logs is a pattern to ensure ACID property of database. Basiclly you write logs before make any changes to database. So you can archive that logs and recorver them on another server.\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-slate-400 font-source text-lg\",\"children\":\"Replication can be achieved by continously archive WAL on primary and applying them on replication.\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-slate-400 font-source text-lg\",\"children\":[\"$\",\"$Lc\",null,{\"href\":\"https://mermaid.live/edit#pako:eNqNkE1Pg0AQhv_KZk41AQKLfO3BxMRjvdiDieBhClMhBZYsH4qE_-6W2qZGY7qH-dj3mcm7O0EqMwIBu1K-pzmqjq2fkprpU2HbkYpXj0tmGXa4xZZuXo8yqjQvBsriU8FaUgOpb7ktcSAnXm0O-dfwovJ_Vfcv9dIZM022xXTfN-z5fq27u7OnE3i2plFFqdT2xgU8ursG4tdALhhQkaqwyPRXToeRBLqcKkpA6DJDtU8gqWfNYd_JzVinIDrVkwF9ox9IDwW-KaxA7LBs9W2D9YuUP3oQE3yA4IFn8dD3uWNHbuAZMIIwncjSrWfbYahDFPj-bMDnssC2Is_jrst1cOxb7s9fc1ad_A\",\"className\":\"text-[#9e98f2] underline\",\"children\":[\"$\",\"$L10\",null,{\"src\":\"https://mermaid.ink/img/pako:eNqNkE1Pg0AQhv_KZk41AQKLfO3BxMRjvdiDieBhClMhBZYsH4qE_-6W2qZGY7qH-dj3mcm7O0EqMwIBu1K-pzmqjq2fkprpU2HbkYpXj0tmGXa4xZZuXo8yqjQvBsriU8FaUgOpb7ktcSAnXm0O-dfwovJ_Vfcv9dIZM022xXTfN-z5fq27u7OnE3i2plFFqdT2xgU8ursG4tdALhhQkaqwyPRXToeRBLqcKkpA6DJDtU8gqWfNYd_JzVinIDrVkwF9ox9IDwW-KaxA7LBs9W2D9YuUP3oQE3yA4IFn8dD3uWNHbuAZMIIwncjSrWfbYahDFPj-bMDnssC2Is_jrst1cOxb7s9fc1ad_A?type=png\",\"alt\":\"\",\"className\":\"rounded-lg my-4 block m-auto\",\"children\":\"$undefined\"}]}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-slate-400 font-source text-lg\",\"children\":\"Note that the process is async by default, so slaves may not be up-to-date with master. This can be solved by streaming WAL over TCP and setup a synchronous slave. Even so, there is a window for data loss should the primary server suffer a catastrophic failure; transactions not yet shipped will be lost\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-slate-400 font-source text-lg\",\"children\":[\"$\",\"$Lc\",null,{\"href\":\"https://mermaid.live/edit#pako:eNp9kE1LxDAQhv9KGFhYoS1tar9yEASP68U9CLYexnbWFvuxJGl1Lf3vpnVlEaUJzDuT551kyAh5VxAIONTde16i1Gz3kLXMrAaVJplu7xdlBWp8QUVXz994s2Eo87IaqEh_EqZIDiTPDlXjQF663c_6p3-hfJX6_9F5X8Zjts0eb3fK6M35wXXM17EPFjQkG6wK8ynjbM5Al9RQBsKkBcq3DLJ2Mj7sdbc_tTkILXuyoD-aOemuwleJDYgD1sqcHrF96rpfNYgRPkDwKHB4HIbccxM_Ciw4gbC9xDFl4LpxbEISheFkwedygeskQcB9n5vgudc8nL4AHKiJ6A\",\"className\":\"text-[#9e98f2] underline\",\"children\":[\"$\",\"$L10\",null,{\"src\":\"https://mermaid.ink/img/pako:eNp9kE1LxDAQhv9KGFhYoS1tar9yEASP68U9CLYexnbWFvuxJGl1Lf3vpnVlEaUJzDuT551kyAh5VxAIONTde16i1Gz3kLXMrAaVJplu7xdlBWp8QUVXz994s2Eo87IaqEh_EqZIDiTPDlXjQF663c_6p3-hfJX6_9F5X8Zjts0eb3fK6M35wXXM17EPFjQkG6wK8ynjbM5Al9RQBsKkBcq3DLJ2Mj7sdbc_tTkILXuyoD-aOemuwleJDYgD1sqcHrF96rpfNYgRPkDwKHB4HIbccxM_Ciw4gbC9xDFl4LpxbEISheFkwedygeskQcB9n5vgudc8nL4AHKiJ6A?type=png\",\"alt\":\"\",\"className\":\"rounded-lg my-4 block m-auto\",\"children\":\"$undefined\"}]}]}],\"\\n\",[\"$\",\"h3\",null,{\"className\":\"text-slate-300 font-source text-xl my-2\",\"children\":\"Slave life-cycle\"}],\"\\n\",[\"$\",\"h3\",null,{\"className\":\"text-slate-300 font-source text-xl my-2\",\"children\":\"Failover problems\"}],\"\\n\",[\"$\",\"h2\",null,{\"className\":\"text-slate-300 font-semibold font-source text-2xl my-3\",\"children\":\"Setup and config\"}],\"\\n\",[\"$\",\"blockquote\",null,{\"className\":\"bg-transparent opacity-80 border-l-4 border-[#34495e] pl-4 my-4\",\"children\":[\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-slate-400 font-source text-lg\",\"children\":[\"Heavily specialize in docker evironment. You can get full setup using docker compose \",[\"$\",\"$Lc\",null,{\"href\":\"https://github.com/ppvan/master-slave-todos\",\"className\":\"text-[#9e98f2] underline\",\"children\":\"here\"}]]}],\"\\n\"]}],\"\\n\",[\"$\",\"h3\",null,{\"className\":\"text-slate-300 font-source text-xl my-2\",\"children\":\"Config master node\"}],\"\\n\",[\"$\",\"h4\",null,{\"className\":\"text-slate-300 font-source text-lg my-1\",\"children\":\"Create archive directory\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"bg-[#21262d] rounded p-1 overflow-x-auto\",\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$11\"},\"className\":\"language-sh\"}]}],\"\\n\",[\"$\",\"h4\",null,{\"className\":\"text-slate-300 font-source text-lg my-1\",\"children\":\"Config postgres.conf\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"bg-[#21262d] rounded p-1 overflow-x-auto\",\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$12\"},\"className\":\"language-conf\"}]}],\"\\n\",[\"$\",\"h4\",null,{\"className\":\"text-slate-300 font-source text-lg my-1\",\"children\":\"Create replication user with replication priviledge\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"bg-[#21262d] rounded p-1 overflow-x-auto\",\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$13\"},\"className\":\"language-sql\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"className\":\"text-slate-300 font-source text-xl my-2\",\"children\":\"Allow remote replica connect\"}],\"\\n\",[\"$\",\"blockquote\",null,{\"className\":\"bg-transparent opacity-80 border-l-4 border-[#34495e] pl-4 my-4\",\"children\":[\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-slate-400 font-source text-lg\",\"children\":\"Add following to the end of pg_hba.conf\"}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"bg-[#21262d] rounded p-1 overflow-x-auto\",\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$14\"},\"className\":\"language-conf\"}]}],\"\\n\",[\"$\",\"h3\",null,{\"className\":\"text-slate-300 font-source text-xl my-2\",\"children\":\"Config slave node\"}],\"\\n\",[\"$\",\"h4\",null,{\"className\":\"text-slate-300 font-source text-lg my-1\",\"children\":\"Replication master data\"}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"bg-[#21262d] rounded p-1 overflow-x-auto\",\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$15\"},\"className\":\"language-sh\"}]}],\"\\n\",[\"$\",\"h4\",null,{\"className\":\"text-slate-300 font-source text-lg my-1\",\"children\":\"Create config and standby.signal\"}],\"\\n\",[\"$\",\"blockquote\",null,{\"className\":\"bg-transparent opacity-80 border-l-4 border-[#34495e] pl-4 my-4\",\"children\":[\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-slate-400 font-source text-lg\",\"children\":\"standby.signal is needed so postgres change to standby mode (slave mode)\"}],\"\\n\"]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"bg-[#21262d] rounded p-1 overflow-x-auto\",\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$16\"},\"className\":\"language-conf\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"bg-[#21262d] rounded p-1 overflow-x-auto\",\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$17\"},\"className\":\"language-conf\"}]}],\"\\n\",[\"$\",\"pre\",null,{\"className\":\"bg-[#21262d] rounded p-1 overflow-x-auto\",\"children\":[\"$\",\"code\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$18\"},\"className\":\"language-sh\"}]}],\"\\n\",[\"$\",\"h2\",null,{\"className\":\"text-slate-300 font-semibold font-source text-2xl my-3\",\"children\":\"Reference\"}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-slate-400 font-source text-lg\",\"children\":[\"$\",\"$Lc\",null,{\"href\":\"https://www.postgresql.org/docs/current/high-availability.html\",\"className\":\"text-[#9e98f2] underline\",\"children\":\"Postgresql documentation, chapter 27\"}]}],\"\\n\",[\"$\",\"p\",null,{\"className\":\"text-slate-400 font-source text-lg\",\"children\":[\"$\",\"$Lc\",null,{\"href\":\"https://www.postgresql.vn/blog/setup_master_slave_for_postgres12\",\"className\":\"text-[#9e98f2] underline\",\"children\":\"Postgres VN, setup master slave\"}]}]]\n"])</script><script>self.__next_f.push([1,"d:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}],[\"$\",\"meta\",\"1\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"2\",{\"children\":\"ppvan's Hub\"}],[\"$\",\"meta\",\"3\",{\"name\":\"description\",\"content\":\"My personal space on the internet\"}],[\"$\",\"meta\",\"4\",{\"name\":\"author\",\"content\":\"Phạm Văn Phúc\"}],[\"$\",\"link\",\"5\",{\"rel\":\"icon\",\"href\":\"/favicon.ico\",\"type\":\"image/x-icon\",\"sizes\":\"128x128\"}],[\"$\",\"meta\",\"6\",{\"name\":\"next-size-adjust\"}]]\n5:null\n"])</script></body></html>